# Obtém a pasta onde o script está localizado (robusto em Intune)$ScriptDir = $PSScriptRoot# Caminho padrão do Windows para wallpapers$WallpaperFolder = "C:\Windows\Web\Wallpaper\Windows"# Caminhos absolutos de origem$DesktopSource = Join-Path $ScriptDir "Wallpaper01.jpg"$LockScreenSource = Join-Path $ScriptDir "Lockscreen01.jpg"# Caminhos de destino$DesktopDest = Join-Path $WallpaperFolder "Wallpaper01.jpg"$LockScreenDest = Join-Path $WallpaperFolder "Lockscreen01.jpg"# Cria a pasta se não existirif (-not (Test-Path $WallpaperFolder)) {    New-Item -Path $WallpaperFolder -ItemType Directory -Force}# Copia arquivos se não existirem ou forem diferentesif (-not (Test-Path $DesktopDest) -or ((Get-FileHash $DesktopSource).Hash -ne (Get-FileHash $DesktopDest).Hash)) {    Copy-Item -Path $DesktopSource -Destination $DesktopDest -Force}if (-not (Test-Path $LockScreenDest) -or ((Get-FileHash $LockScreenSource).Hash -ne (Get-FileHash $LockScreenDest).Hash)) {    Copy-Item -Path $LockScreenSource -Destination $LockScreenDest -Force}# Define papel de parede via registro (HKCU)$DesktopWallpaperRegPath = "HKCU:\Control Panel\Desktop"Set-ItemProperty -Path $DesktopWallpaperRegPath -Name Wallpaper -Value $DesktopDest# Atualiza imediatamenterundll32.exe user32.dll, UpdatePerUserSystemParameters# Define LockScreen via política (HKLM)$LockScreenRegPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\PersonalizationCSP"if (-not (Test-Path $LockScreenRegPath)) {    New-Item -Path $LockScreenRegPath -Force}# Define valores do CSPSet-ItemProperty -Path $LockScreenRegPath -Name LockScreenImagePath -Value $LockScreenDest -Type StringSet-ItemProperty -Path $LockScreenRegPath -Name LockScreenImageUrl -Value $LockScreenDest -Type StringSet-ItemProperty -Path $LockScreenRegPath -Name LockScreenImageStatus -Value 1 -Type DWord